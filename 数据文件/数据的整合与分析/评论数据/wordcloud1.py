import wordcloud
import jieba
from jieba import posseg
import collections
from PIL import Image
import matplotlib.pyplot as plt
import numpy as np

with open('summar_comment.txt', 'r', encoding='utf-8') as f:
    data_all = f.read().split('kkkkkkkkkkkkkkkkkk')
mask = np.array(Image.open('m.PNG')) 
wc = wordcloud.WordCloud(background_color='white', font_path='C:\Windows\Fonts\simkai.ttf',mask=mask, max_words=100, max_font_size=100 ,scale=5)
id_=['100005171159', '100002942753', '100004363846', '11393447962', '25839850983', '100006420674', '45774171423', '62764268649', '53679741525', '100006728984', '100006189013', '33793204889', '25705393051', '31478221832', '100009906628', '100005217577', '69192830845', '65956432373', '26877580263', '65384259013', '69337243068', '100013174332', '100009083138', '100006143642', '1803497349', '10453386710', '69534408909', '100006460635', '54727395733', '100005715053', '100010880906', '100003052761', '100000503382', '100009083150', '10260574953', '100005603836', '33591698226', '26300614576', '55643660253', '100010342216', '100012720994', '28637832384', '100005724680', '100009238688', '100008029460', '66808247251', '100013320628', '100010409532', '28694162119', '28219713450', '47538112007', '46412107441', '100004681589', '48125745396', '38011702650', '41366188621', '100005188045', '28540718576', '44086489053', '10081221177', '65776237672', '47484466625', '49097402049', '67438836386', '100006295053', '36295210229', '69173845286', '21503487289', '100006893703', '55325663401', '5225346', '67438836383', '1635645229', '100007136957', '64749684366', '100013206314', '26848709806', '55971091215', '61123578382', '31014227526', '26153597886', '100007206699', '29748690161', '100004365311', '29668377581', '100004508927', '33793204884', '63793036738', '44714563331', '100013381490', '64093650521', '100005606318', '27070065378', '100009898546', '27914580583', '100006611324', '100013068434', '100006365929', '100005803681', '27150846059', '59448886400', '44308114143', '100007990368', '100007136939', '44075986106', '30540777636', '35609855267', '100005167987', '65028666412', '42377878261', '100007413706', '12579070740', '100003546757', '100007413704', '100006757410', '25613387106', '29260057586', '100009906660', '54282706675', '48834920995', '48567740023', '11943085270', '13646778369', '54250941032', '65856580959', '16279398501', '100003693799', '27930056753', '42614385419', '100004790375', '100013068430', '28196614899', '35013975678', '41888723521', '57128605448', '59376667239', '6663565', '100008645044', '100006302835', '67664942017', '16637980022', '100007317098', '31155959262', '47878949721', '61575184254', '100007317132', '42377878260', '64432328835', '100003269299', '10051460175', '100011177202', '62624098642', '65688181695', '16846935048', '56363222100', '62618361265', '50990512243', '61111756216', '44075986104', '59576139917', '100006809447', '100008100130', '65956432390', '65466349541', '67337161974', '50576630686', '100002674315', '100003898883', '69804070678', '62620009485', '59293840553', '100011979236', '65956432384', '43158970766', '100012522512', '100009645476', '63837492993', '100007443967', '47113585704', '40779876137', '100005338865', '100012038778', '16230583051', '100006611304', '52128280830', '47474669249', '100011386554', '100009186364', '66405403375', '100006159798', '100011773072', '11038818381', '48108848471', '35922082822', '10743693831', '100004707528', '36324360011', '29510670326', '34309184495', '100012885264', '67468340379', '100012038800', '61216591844', '28712276705', '51355738851', '100009083154', '100012955124', '42432478665', '28299926952', '60404539126', '100009083152', '63725554711', '100008492950', '100011316494', '22298647726', '100004049003', '46674015740', '61111756214', '100009972372', '59907295735', '100011316106', '68059356116', '100009182602', '28206239565', '66480361384', '55544919014', '61095480979', '100005584115', '65956432391', '22223895618', '68467927048', '100011677348', '61617597219', '17215189912', '100012698256', '100005171461', '60380476105', '13374931741', '100006546527', '100011045982', '55594095057', '100010370676', '33151285285', '55971091214', '21235096378', '68042747672', '11465480986', '49985658062', '27914580586', '100006729770', '14184533666', '65398481449', '100009645478', '64601238858', '100006433544', '40979483632', '19875619158', '100011517222', '100005550829', '45123262331', '100004239719', '6072614', '100009645502', '100007693298', '29467374699', '30117505153', '60671841224', '100005224917', '39953852223', '37406096651', '100007233381', '65354864556', '40100696316', '100009186366', '57359500408', '53814817540', '17928948059', '100009972396', '100010370680', '53066721080', '47035401787', '67836424584', '50328416358', '32769481277', '63053915030', '28316606259', '100004405051', '11095030418', '100012885246', '52858503634', '100007311665', '26877580262', '60398891420', '58207088793', '31391469607', '100005928469', '100006706156', '5728435', '67278652521', '23775777471', '14541812608', '44086489049', '60185181568', '49853093373', '45597532288', '29870968292', '62258854339', '24877362143', '55405970137', '41352840945', '16770177637', '100001735021', '35374530418', '28712276704', '100005625412', '61111756217', '100004697882', '27116355741', '100004364088', '100007270267', '24217778538', '100007539322', '41112670787', '48471796302', '100005217591', '100011979232', '23775777472', '100010056732', '6076609', '52578635181', '100003406361', '100012522500', '24162089168', '31014227524', '56722942303', '100011316466']
for index, data in enumerate(data_all):
    if data!='' and eval(data):
        data_2 = ','.join(eval(data))
        data_dealed = posseg.cut(data_2)
        result_pre=[]
        for word, flag in data_dealed:
            if flag != 'c' and flag != 'p' and flag != 'w' and flag != 'y' and flag != 'e':
                result_pre.append(word) 
        result=[]
        remove_list = ['了','的','是','（','）','}','{','很','就','我','不',' ',',','，','：','；','用','有','','也','！','其他','挺','都','还是','外形','效果','买','真的','？','电脑','京东','问题','.','还','中','和',r'\\','?','啊','但是','什么','这','又','没有','好像','一样','你','个','突然','没','直接','下单','一个','电影','']
        for word in result_pre:
            if word not in remove_list:
                result.append(word)
        counts = collections.Counter(result)
        wc.generate_from_frequencies(counts)  
        image_colors = wordcloud.ImageColorGenerator(mask) 
        wc.recolor(color_func=image_colors)  
        wc.to_file(id_[index] + ".jpg")  
        









'''with open('comment_median.txt', 'r', encoding='utf-8') as f:
    data_all = f.read().split('kkkkkkkkkkkkkkkkkk')
for data in data_all:'''
